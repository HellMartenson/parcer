function getDistanceFromLatLonInKm(t,e,n,o){var i=deg2rad(n-t),r=deg2rad(o-e),a=Math.sin(i/2)*Math.sin(i/2)+Math.cos(deg2rad(t))*Math.cos(deg2rad(n))*Math.sin(r/2)*Math.sin(r/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371}function deg2rad(t){return t*(Math.PI/180)}function getMiddlePointCoordinates(t,e,n,o,i,r){void 0===i&&(i=0),0!==r&&(r=r>0?1:-1);var a=(t+n)/2,c=(e+o)/2,s=i*Math.sqrt(.5);return{x:a+r*s,y:c-r*s}}function numberFormat(number,decimals,decPoint,thousandsSeparator){if(isNaN(decimals=+decimals)&&((decimals=0)||!0)||(decimals=Math.min(Math.max(0,decimals),20)),!(decPoint instanceof String)&&"string"!=typeof decPoint&&(decPoint="."),!(thousandsSeparator instanceof String)&&"string"!=typeof thousandsSeparator&&(thousandsSeparator=","),isNaN(parseFloat(number))||isNaN(number=+number)||!isFinite(number))return(0).toFixed(decimals).replace(".",decPoint);var isNegative=number<0;number=Math.abs(number);var intPartStr=parseInt(Math.abs(number)).toString(),floatPartStr=number.toString().substr(intPartStr.length+1);return floatPartStr.length<=decimals?floatPartStr=(floatPartStr+(0).toFixed(decimals).substr(2)).substr(0,decimals):(number=(+intPartStr+1*(("0"+floatPartStr).substr(0,decimals)+function(q){var r=q.replace(/(\d)[1-4]+$/,"$1").replace(/(\d)[5-9]+$/,"$1+1");return q=(/^\d{2,}\+/.test(r)&&"0"==r[0]?r.match(/^0+/)[0]:"")+(r?eval(r.replace(/^0+/,"")||0).toString():r),q.length>1?arguments.callee(q):q}(("0"+floatPartStr).substr(decimals))).replace(/^(\d)/,"$1.")).toString(),intPartStr=parseInt(number).toString(),floatPartStr=(number.substring(intPartStr.length+1)+(0).toFixed(decimals)).substr(0,decimals)),"0"!=intPartStr&&(intPartStr=((0).toFixed(3-(intPartStr.length%3||3)).substr(2)+intPartStr).replace(/(\d{3}(?!$))/g,"$1"+thousandsSeparator).replace(/^(-)?0+\s*/,"$1")),(isNegative?"-":"")+intPartStr+(floatPartStr?decPoint+floatPartStr:"")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e,n){e(t).on("change",'[data-role="agree-input"]',function(){var t=e(this),n=t.closest('[data-role="agree-checker-container"]'),o=[],i=n.attr("data-target");if(""!==i&&void 0!==i&&(o=e(i)),0===o.length){var r=n.closest("FORM");0!==r.length&&(o=r.find('[type="submit"]'),0===o.length&&(o=r.find("BUTTON:last")))}0!==o.length&&o.prop("disabled",!1===t.is(":checked"))}),e(t).on("click",'[data-role="agree-label"]',function(){var t=e(this).closest('[data-role="agree-checker-container"]'),n=t.find('[data-role="agree-input"]');n.prop("checked",!n.is(":checked")),n.change()}),e(t).on("click",'[data-role="agree-label"] A',function(t){t.stopPropagation()})}(document,jQuery),function(t,e,n,o){var i=e.querySelector("head"),r={},a={};n.REGISTERED_JS_KEYS=n.REGISTERED_JS_KEYS||[];var c=function t(){if(!1===Object.values(a).every(function(t){return t}))return void setTimeout(t,1);var n=[].slice.call(e.querySelectorAll("[data-show-after-load]"));0!==n.length&&n.forEach(function(t){t.hidden=!1})};t(e).ajaxComplete(function(){setTimeout(c,300)}),t(e).ajaxSuccess(function(t,s,l,u){if(o!==u&&o!==u.assets){u.assets.jsFiles.forEach(function(t){var n=/.*\/(assets|static\/\d+)\/\w{4,8}(\/.+)/,o=t.replace(n,"$2"),a='script[src$="'+o+'"]',c=e.querySelector(a);null!==c&&c.src.replace(n,"$2")===o||(c=e.createElement("script"),c.src=t,r[t]=!1,c.onload=function(){r[t]=!0},i.appendChild(c))}),u.assets.cssFiles.forEach(function(t){a[t.url]=!1,n.defferCSS(t.url,t.media).then(function(){a[t.url]=!0})}),Object.keys(u.assets.inlineCss).forEach(function(t){var n='link[data-asset-key="'+t+'"]',o=e.querySelector(n);null===o&&(o=e.createElement("div"),o.innerHTML=u.assets.inlineCss[t],i.appendChild(o.firstChild))});var d=function(){var t=[];if(Object.keys(u.assets.inlineJs).forEach(function(e){-1===n.REGISTERED_JS_KEYS.indexOf(e)&&(t.push(u.assets.inlineJs[e]),n.REGISTERED_JS_KEYS.push(e))}),0!==t.length){var o=e.createElement("script");o.type="text/javascript",o.innerHTML=t.join("\n"),i.appendChild(o)}};!function t(){if(!1===Object.keys(r).every(function(t){return!0===r[t]}))return void setTimeout(t,1);d()}(),c()}})}(jQuery,document,window,void 0),function(t,e,n){n.changeCity=function(t){n.sendChangeCityRequest(t,function(){if(void 0!==URL){var t=new URL(n.location.href);if(null!==t.searchParams.get("city"))return t.searchParams.delete("city"),void n.location.replace(t.href)}n.location.reload()})},n.setCity=function(e){n.sendChangeCityRequest(e,function(){var e=t('[data-role="dropdown-city"]');e.closest(".header-top-menu__common-link").removeClass("w-choose-city-widget_city-select-popover-open"),e.remove()})},n.sendChangeCityRequest=function(o){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};n.CHANGE_CITY_URL=n.CHANGE_CITY_URL||"",""!==n.CHANGE_CITY_URL&&(n.toggleLoaderVisibility(!0),t.ajax({url:n.CHANGE_CITY_URL,dataType:"JSON",cache:!1,data:{city_guid:o},success:function(o){if(1===o.result){if(t("[data-role=city-shops-page]").length&&(e.cookie="to_city_shops=1;path=/;expires=0"),!0===n.location.href.includes("shops"))return n.location.assign(n.location.origin+"/shops/"+o.citySlug),!1;i(o)}}}).always(function(){n.toggleLoaderVisibility(!1)}))}}(jQuery,document,window),$(function(){if(0!==document.querySelectorAll('[data-role="clipboard-button"]').length){new Clipboard('[data-role="clipboard-button"]').on("success",function(t){$(t.trigger).attr("title","Скопировано").tooltip({container:"body",placement:"bottom"})})}}),function(t,e,n){t(function(){var e=function(){return void 0!==window.ga};t("body").on("click","[data-commerce-target]",function(){if(e()){var n=t(this),o=n.attr("data-commerce-target");try{o=JSON.parse(o)}catch(t){}"string"==typeof o&&(o=[o]);var i=n.attr("data-commerce-category")||"button",r=n.attr("data-commerce-action")||"click";o.forEach(function(t){window.ga&&window.ga("send","event",i,r,t)})}})})}(jQuery,document),function(t,e){e.EVENT_CHANGE_HEADER_FIXED_STATE="change:header[fixed]",e.EVENT_HARD_CHECK_HEADER_FIXED_STATE="check:header[fixed]",e.SELECTOR_HEADER_SEARCH="#header-search",e.EVENT_OPEN_SEARCH="open:search",e.EVENT_CLOSE_SEARCH="close:search";var n=void 0;e.EVENT_SCROLLING_MOBILE_MENU="mobile:menu:scrolling",e.EVENT_MENU_DESKTOP_CATALOG_BTN_SHOW="menu:desktop:catalog-btn:show",e.EVENT_MENU_DESKTOP_CATALOG_BTN_HIDE="menu:desktop:catalog-btn:hide",t(function(){var o=void 0===e.isNeedFixedHeader||!0===e.isNeedFixedHeader;if(n=t(e.SELECTOR_HEADER_SEARCH),n.length){var i=n.get(0).getBoundingClientRect(),r=i.top+e.pageYOffset,a=!1;n.addClass("slide");var c=n.find("[data-menu-desktop-toggle]"),s=n.find("[data-menu-desktop-wrap]"),l=n.find(".logo-container"),u=function(){var t=void 0;t=n.hasClass("navbar-fixed-top")?n.get(0).clientHeight:document.querySelector("header").clientHeight,s.css("max-height","calc(100vh - "+t+"px)"),s.css("width","calc(100vw - "+(s.offset().left+30)+"px)")},d=function(t){void 0===t&&(t=!s.hasClass("menu-desktop-wrap_showed")),s.toggleClass("menu-desktop-wrap_showed",t),u(),c.toggleClass("active",t)},E=function(t){l.toggleClass("large-btn",t),!1===t&&d(!1)};c.on("click",function(){d()}),t(document).on("click",function(e){var n=t(e.target);0===n.closest(".menu-desktop").length&&0===n.closest("[data-menu-desktop-toggle]").length&&d(!1)}),e.addEventListener(e.EVENT_MENU_DESKTOP_CATALOG_BTN_SHOW,function(){E(!0),t(".presearch").addClass("presearch_scale-width")}),e.addEventListener(e.EVENT_MENU_DESKTOP_CATALOG_BTN_HIDE,function(){E(!1),t(".presearch").removeClass("presearch_scale-width")}),!0===o&&(t(e).scroll(function(){if(!e.checkScreenType(e.SCREEN_MOBILE,e.SCREEN_TABLET)){if(!a&&e.pageYOffset>=r)n.addClass("navbar-fixed-top"),e.checkScreenType(e.SCREEN_DESKTOP,e.SCREEN_WIDE)?t("header").css("padding-bottom",n.get(0).getBoundingClientRect().height):t("header").css("padding-bottom",0),a=!0,u();else{if(!(a&&e.pageYOffset<=r))return;n.removeClass("navbar-fixed-top"),e.checkScreenType(e.SCREEN_DESKTOP,e.SCREEN_WIDE)&&t("header").css("padding-bottom",0),a=!1,u()}e.dispatchEvent(new CustomEvent(e.EVENT_CHANGE_HEADER_FIXED_STATE,{detail:{isFixed:a}}))}}),t(e).trigger("scroll")),t(e).on([e.EVENT_HARD_CHECK_HEADER_FIXED_STATE,"resize"].join(" "),function(){e.dispatchEvent(new CustomEvent(e.EVENT_CHANGE_HEADER_FIXED_STATE,{detail:{isFixed:a}}))})}})}(jQuery,window),function(t,e,n){function o(){window.PieChartClusterer=function(t){PieChartClusterer.superclass.constructor.apply(this,arguments)},PieChartClusterer.COLORS={blue:"0A6CC8",darkblue:"3D4AE9",darkgreen:"158B02",darkorange:"CD6D2D",green:"1AB500",gray:"94948E",lightblue:"4391E7",night:"143A6B",orange:"CCA42B",pink:"E666DD",red:"E03632",violet:"A41DE2",white:"FFFFFF",yellow:"D4C62C",brown:"946134",black:"000000"},PieChartClusterer.SIZES=[[65,65],[80,80],[95,95]],PieChartClusterer.NUMBERS=[10,100],PieChartClusterer.OPACITY=.9,PieChartClusterer.URL_TEMPLATE=["//chart.googleapis.com/chart?cht=pc","chs=#{width}x#{height}","chd=t:1|#{data}","chco=FFFFFF,#{colors}","chf=a,s,000000#{opacity}|bg,s,00000000"].join("&"),PieChartClusterer.dec2hex=function(t){var e=Math.floor(255*t).toString(16);return e.length<2&&"0"+e||e},PieChartClusterer.rgb2hex=function(t){var e=t.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+)/i);return e&&4===e.length?("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):t},ymaps.util.augment(PieChartClusterer,ymaps.Clusterer,{createCluster:function(t,e){var n=PieChartClusterer.superclass.createCluster.apply(this,arguments);return n.options.set({icons:this.getClusterIcons(e),numbers:this.getClusterNumbers()}),n},getClusterNumbers:function(){return this.options.get("clusterNumbers",PieChartClusterer.NUMBERS)},getClusterIconOpacity:function(){return this.options.get("clusterIconOpacity",PieChartClusterer.OPACITY)},getClusterIconSizes:function(){var t=this.options.get("clusterIcons");if(t){for(var e,n=[],o=0;e=t[o]&&t[o].size;)n[o++]=e;return n}return PieChartClusterer.SIZES},getClusterIcons:function(t){for(var e,n=this.getClusterIconSizes(),o=0,i=[];e=n[o];)i[o++]={href:this.formatClusterIconHref(e,this.getClusterIconColors(t)),size:e,offset:[-Math.floor(e[0]/2),-Math.floor(e[1]/2)]};return i},getClusterIconColors:function(t){for(var e,n,o=t.length,i={};n=t[--o];)e=this.getColor(n),i[e]=i[e]+1||1;return i},formatClusterIconHref:function(t,e){var n=[],o=[],i=0;for(o[i]in e)n[i]=e[o[i++]];var r={width:t[0],height:t[1],data:n.join(","),colors:(o.length<2?[o[0],o[0]]:o).join("|"),opacity:PieChartClusterer.dec2hex(this.getClusterIconOpacity())};return PieChartClusterer.URL_TEMPLATE.replace(/#{(\w+)}/g,function(t,e){return r[e]})},getColor:function(t){if(t.options.get("iconColor",!1)){var e=t.options.get("iconColor").replace("#","");return PieChartClusterer.COLORS[e.toLowerCase()]||PieChartClusterer.rgb2hex(e)}return t.options.get("preset","twirl#blueIcon").match(/#([a-z]+)[A-Z]/)[1]}})}window.initPieChartClusterer=function(){if(!window.PieChartClusterer)return void 0===window.ymaps.util?void setTimeout(window.initPieChartClusterer,100):void o()}}(document,jQuery),function(){String.prototype.countPostfix=function(t,e,n,o){var i=0;n&&(n=!0),o&&"string"==typeof o.valueOf()||(o="%c %w"),e instanceof Object||(e=e||0==e||""==e?{0:0==e||e?e.valueOf():0}:{});var r=this instanceof Object?this.valueOf():String(this);if(r in e)return String(e[r]);(r=+String(this instanceof Object?this.valueOf():String(this)).replace(/[^\d]+/g,""))||(r=0);var a=r%10,c=r%100;a>=2&&a<=4&&(i=1),(0==a||a>=5&&a<=9||c>=11&&c<=19)&&(i=2);var s=t[Math.min(i,t.length)]||"";return 0==n?o.replace(/([^%]|^)%c/gim,"$1"+r.toString()).replace(/([^%]|^)%w/gim,"$1"+s).replace(/%%/gim,"%"):s},String.countPostfix=function(t,e,n,o,i){return String.prototype.countPostfix.call(t,e,n,o,i)}}(),function(t,e,n,o){n.EVENT_GEOLOCATION_INIT="user-geolocation:init",n.POSITION_ERROR_PERMISSION_DENIED=1,n.POSITION_ERROR_POSITION_UNAVAILABLE=2,n.POSITION_ERROR_TIMEOUT=3,n.GEOLOCATION_PERMISSION_GRANTED="granted",n.GEOLOCATION_PERMISSION_PROMPT="prompt",n.GEOLOCATION_PERMISSION_DENIED="denied";var i=function(){var o=!1,i=void 0,r=void 0,a=void 0;void 0!==e.permissions&&e.permissions.query({name:"geolocation"}).then(function(t){a=t,o=n.GEOLOCATION_PERMISSION_GRANTED===t}),this.init=function(){var c=function(e){i=e,o=!0,a=n.GEOLOCATION_PERMISSION_GRANTED,t(n).trigger(n.EVENT_GEOLOCATION_INIT),n.dispatchEvent(new CustomEvent(n.EVENT_GEOLOCATION_INIT))},s=function(e){r=e,o=n.POSITION_ERROR_PERMISSION_DENIED!==e.code,n.POSITION_ERROR_PERMISSION_DENIED===e.code&&(a=n.GEOLOCATION_PERMISSION_DENIED),t(n).trigger(n.EVENT_GEOLOCATION_INIT),n.dispatchEvent(new CustomEvent(n.EVENT_GEOLOCATION_INIT))};!1!="geolocation"in e&&e.geolocation.getCurrentPosition(c,s)},this.isAvailable=function(){return o},this.getPosition=function(){return i},this.getPositionError=function(){return r},this.checkPermission=function(t){if(!1==t instanceof Array&&1===arguments.length)return t===a;var e=!1,n=[];return t instanceof Array?n=t:arguments.length>1&&Array.prototype.push.apply(n,arguments),e=!1,n.forEach(function(t){e|=t===a}),1===e}};n.UserGeolocation=new i}(jQuery,navigator,window),function(t,e){function n(){var e=getScreenType(),n=e!==t.screenType;t.screenType=e,n&&o.trigger(EVENT_CHANGE_SCREEN_TYPE),o.trigger(":resize")}t.SCREEN_WIDE=1,t.SCREEN_DESKTOP=2,t.SCREEN_TABLET=3,t.SCREEN_MOBILE=4,t.SCREEN_NOT_SUPPORTED=0,t.SCREEN_MOBILE_MIN_WIDTH=320,t.SCREEN_MOBILE_MAX_WIDTH=767,t.SCREEN_TABLET_MAX_WIDTH=991,t.SCREEN_DESKTOP_MAX_WIDTH=1199,t.EVENT_CHANGE_SCREEN_TYPE="window.screen.type:changed",t.getScreenType=function(){var e=t.matchMedia;if(e){if(e("(min-width: "+(SCREEN_DESKTOP_MAX_WIDTH+1)+"px)").matches)return SCREEN_WIDE;if(e("(min-width: "+(SCREEN_TABLET_MAX_WIDTH+1)+"px)").matches)return SCREEN_DESKTOP;if(e("(min-width: "+(SCREEN_MOBILE_MAX_WIDTH+1)+"px)").matches)return SCREEN_TABLET;if(e("(min-width: "+(SCREEN_MOBILE_MIN_WIDTH+1)+"px)").matches)return SCREEN_MOBILE}else{var n=t.innerWidth;if(n>SCREEN_DESKTOP_MAX_WIDTH)return SCREEN_WIDE;if(n>SCREEN_TABLET_MAX_WIDTH)return SCREEN_DESKTOP;if(n>SCREEN_MOBILE_MAX_WIDTH)return SCREEN_TABLET;if(n>=SCREEN_MOBILE_MIN_WIDTH)return SCREEN_MOBILE}return SCREEN_NOT_SUPPORTED},t.checkScreenType=function(e){if(!(e instanceof Array)&&1===arguments.length)return e===t.getScreenType();var n=!1,o=[];e instanceof Array?o=e:arguments.length>1&&Array.prototype.push.apply(o,arguments);for(var i=0,r=o.length;i<r;++i)n|=o[i]==t.getScreenType();return n};var o=e(t);!function(){var n={};n[t.SCREEN_MOBILE]="mobile",n[t.SCREEN_TABLET]="tablet",n[t.SCREEN_DESKTOP]="desktop",n[t.SCREEN_WIDE]="wide",e.fn.setScrollingStateFor=function(t,o){o instanceof Array||!o||(o=[o]),o||(o=[]);var i="";0==o.length&&(i="not-scrolling");for(var r=0,a=o.length;r<a;++r){var c=o[r],s=n[c];i+=i?" ":"",i+="not-scrolling"+(s?"-":"")+s}var l=e(this);return t?l.addClass(i):l.removeClass(i)}}(),o.resize(n).trigger("resize"),o.get(0).onresize=n}(window,jQuery),$(function(){window.PHONE_MASK="+7 (xxx) xxx-xxxx",$("input[data-phone]").each(function(){$(this).maskedphone(window.PHONE_MASK)})}),function(t){function e(t,e){if(!(t.originalEvent.touches.length>1)){t.preventDefault();var n=t.originalEvent.changedTouches[0],o=document.createEvent("MouseEvents");o.initMouseEvent(e,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(o)}}if(t.support.touch="ontouchend"in document,t.support.touch){var n,o=t.ui.mouse.prototype,i=o._mouseInit,r=o._mouseDestroy;o._touchStart=function(t){var o=this;!n&&o._mouseCapture(t.originalEvent.changedTouches[0])&&(n=!0,o._touchMoved=!1,e(t,"mouseover"),e(t,"mousemove"),e(t,"mousedown"))},o._touchMove=function(t){n&&(this._touchMoved=!0,e(t,"mousemove"))},o._touchEnd=function(t){n&&(e(t,"mouseup"),e(t,"mouseout"),this._touchMoved||e(t,"click"),n=!1)},o._mouseInit=function(){var e=this;e.element.bind({touchstart:t.proxy(e,"_touchStart"),touchmove:t.proxy(e,"_touchMove"),touchend:t.proxy(e,"_touchEnd")}),i.call(e)},o._mouseDestroy=function(){var e=this;e.element.unbind({touchstart:t.proxy(e,"_touchStart"),touchmove:t.proxy(e,"_touchMove"),touchend:t.proxy(e,"_touchEnd")}),r.call(e)}}}(jQuery),function(t,e,n){function o(){if(n===window.ymaps)return void setTimeout(o);for(window.initPieChartClusterer&&window.initPieChartClusterer();i.length;){var t=i.shift();window.ymaps.ready(t)}}var i=[],r=!1;window.loadYandexMaps=function(t,a){n===a&&(a="ru_RU"),!1===e.isFunction(t)&&(t=function(){}),i.push(t),!1===r?(e.getScript("//api-maps.yandex.ru/2.1.74/?lang="+a,o),r=!0):o()}}(document,jQuery),window.toggleLoaderVisibility=function(t){void 0===t&&(t=!document.body.classList.contains("loading")),!0===t?document.body.classList.add("loading"):document.body.classList.remove("loading")},window.dispatchLazyLoadUpdateEvent=function(){var t=document.createEvent("Event");t.initEvent(window.EVENT_LAZY_LOAD_UPDATE||"LazyLoadUpdate",!0,!0),window.dispatchEvent(t)},function(){document.addEventListener("DOMContentLoaded",function(){var t=[].slice.call(document.querySelectorAll("[data-show-after-load]"));0!==t.length&&t.forEach(function(t){setTimeout(function(){t.hidden=!1},0)})})}(),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"===("undefined"==typeof exports?"undefined":_typeof(exports))?require("jquery"):jQuery)}(function(t){var e,n=navigator.userAgent,o=/iphone/i.test(n),i=/chrome/i.test(n),r=/android/i.test(n);t.maskedphone={definitions:{x:"[0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},t.fn.extend({caret:function(t,e){var n;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof t?(e="number"==typeof e?e:t,this.each(function(){this.setSelectionRange?this.setSelectionRange(t,e):this.createTextRange&&(n=this.createTextRange(),n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",t),n.select())})):(this[0].setSelectionRange?(t=this[0].selectionStart,e=this[0].selectionEnd):document.selection&&document.selection.createRange&&(n=document.selection.createRange(),t=0-n.duplicate().moveStart("character",-1e5),e=t+n.text.length),{begin:t,end:e})},unmaskedphone:function(){return this.trigger("unmask")},maskedphone:function(n,a){var c,s,l,u,d,E,h,f;if(!n&&this.length>0){c=t(this[0]);var p=c.data(t.maskedphone.dataName);return p?p():void 0}return a=t.extend({autoclear:t.maskedphone.autoclear,placeholder:t.maskedphone.placeholder,completed:null},a),s=t.maskedphone.definitions,l=[],u=h=n.length,d=null,t.each(n.split(""),function(t,e){"?"==e?(h--,u=t):s[e]?(l.push(new RegExp(s[e])),null===d&&(d=l.length-1),t<u&&(E=l.length-1)):l.push(null)}),this.trigger("unmask").each(function(){function c(){if(a.completed){for(var t=d;t<=E;t++)if(l[t]&&R[t]===p(t))return;a.completed.call(I)}}function p(t){return t<a.placeholder.length?a.placeholder.charAt(t):a.placeholder.charAt(0)}function g(t){for(;++t<h&&!l[t];);return t}function m(t){for(;--t>=0&&!l[t];);return t}function _(t,e){var n,o;if(!(t<0)){for(n=t,o=g(e);n<h;n++)if(l[n]){if(!(o<h&&l[n].test(R[o])))break;R[n]=R[o],R[o]=p(o),o=g(o)}w(),I.caret(Math.max(d,t))}}function v(t){var e,n,o,i;for(e=t,n=p(t);e<h;e++)if(l[e]){if(o=g(e),i=R[e],R[e]=n,!(o<h&&l[o].test(i)))break;n=i}}function S(t){var e=I.val(),n=I.caret();if(f&&f.length&&f.length>e.length){for(N(!0);n.begin>0&&!l[n.begin-1];)n.begin--;if(0===n.begin)for(;n.begin<d&&!l[n.begin];)n.begin++;I.caret(n.begin,n.begin)}else{for(N(!0);n.begin<h&&!l[n.begin];)n.begin++;I.caret(n.begin,n.begin)}c()}function C(t){N(),I.val()!=b&&I.change()}function T(t){if(!I.prop("readonly")){var e,n,i,r=t.which||t.keyCode;f=I.val(),8===r||46===r||o&&127===r?(e=I.caret(),n=e.begin,i=e.end,i-n==0&&(n=46!==r?m(n):i=g(n-1),i=46===r?g(i):i),y(n,i),_(n,i-1),t.preventDefault()):13===r?C.call(this,t):27===r&&(I.val(b),I.caret(0,N()),t.preventDefault())}}function O(e){if(!I.prop("readonly")){var n,o,i,a=e.which||e.keyCode,s=I.caret();if(!(e.ctrlKey||e.altKey||e.metaKey||a<32)&&a&&13!==a){if(s.end-s.begin!=0&&(y(s.begin,s.end),_(s.begin,s.end-1)),(n=g(s.begin-1))<h&&(o=String.fromCharCode(a),l[n].test(o))){if(v(n),R[n]=o,w(),i=g(n),r){var u=function(){t.proxy(t.fn.caret,I,i)()};setTimeout(u,0)}else I.caret(i);s.begin<=E&&c()}e.preventDefault()}}}function y(t,e){var n;for(n=t;n<e&&n<h;n++)l[n]&&(R[n]=p(n))}function w(){I.val(R.join(""))}function N(t){var e,n,o,i=I.val(),r=-1;for(e=0,o=0;e<h;e++)if(l[e]){for(R[e]=p(e);o++<i.length;)if(n=i.charAt(o-1),l[e].test(n)){R[e]=n,r=e;break}if(o>i.length){y(e+1,h);break}}else R[e]===i.charAt(o)&&o++,e<u&&(r=e);return t?w():r+1<u?a.autoclear||R.join("")===P?(I.val()&&I.val(""),y(0,h)):w():(w(),I.val(I.val().substring(0,r+1))),u?e:d}var I=t(this),R=t.map(n.split(""),function(t,e){if("?"!=t)return s[t]?p(e):t}),P=R.join(""),b=I.val();I.data(t.maskedphone.dataName,function(){return t.map(R,function(t,e){return l[e]&&t!=p(e)?t:null}).join("")}),I.one("unmaskedphone",function(){I.off(".maskedphone").removeData(t.maskedphone.dataName)}).on("focus.maskedphone",function(){if(!I.prop("readonly")){clearTimeout(e);var t;b=I.val(),t=N(),e=setTimeout(function(){I.get(0)===document.activeElement&&(w(),t==n.replace("?","").length?I.caret(0,t):I.caret(t))},10)}}).on("blur.maskedphone",C).on("keydown.maskedphone",T).on("keypress.maskedphone",O).on("input.maskedphone paste.maskedphone",function(){I.prop("readonly")||setTimeout(function(){var t=N(!0);I.caret(t),c()},0)}),i&&r&&I.off("input.maskedphone").on("input.maskedphone",S),N()})}})}),window.SELECTOR_POPOVER='[data-toggle="popover"]',window.EVENT_INIT_POPOVERS="popovers:init",window.EVENT_DESTROY_POPOVERS="popovers:destroy";var initPopovers=function(){void 0!==$(window).popover&&(destroyPopovers(),$(window.SELECTOR_POPOVER).on("show.bs.popover",function(){$(window.SELECTOR_POPOVER).not(this).popover("hide")}),$(window.SELECTOR_POPOVER).on("hidden.bs.popover",function(){$(this).data("bs.popover").inState.click=!1}),[].slice.call(document.querySelectorAll(window.SELECTOR_POPOVER)).forEach(function(t){var e=$(t);e.popover({html:!0,content:function(){var t=e.data("content-target");return t=$(t).html(),t||e.data("content")}})}))},destroyPopovers=function(){void 0!==$(window).popover&&$(window.SELECTOR_POPOVER).popover("destroy")};$(function(){initPopovers(),$(document.body).click(function(t){if(void 0!==$(window).popover&&"tooltip"!==$(t.target).parent().attr("role")){var e=$(t.target).closest(window.SELECTOR_POPOVER);if(e.length)return void[].slice.call(document.querySelectorAll(window.SELECTOR_POPOVER)).forEach(function(t){var n=$(t);n.data("content-target")!==e.data("content-target")&&n.popover("hide")});$(window.SELECTOR_POPOVER).popover("hide")}})}),$(window).on(window.EVENT_INIT_POPOVERS,initPopovers).on(window.EVENT_DESTROY_POPOVERS,destroyPopovers),window.SELECTOR_TOOLTIP='[data-toggle="tooltip"], [data-original-title]',window.EVENT_INIT_TOOLTIPS="tooltips:init",window.EVENT_DESTROY_TOOLTIPS="tooltips:destroy";var initTooltips=function(){void 0!==$(window).tooltip&&(destroyTooltips(),setTimeout(function(){$(window.SELECTOR_TOOLTIP).each(function(){var t=$(this);t.tooltip({container:t.data("container")?t.data("container"):"body",placement:t.data("placement")?t.data("placement"):"bottom",trigger:t.data("trigger")?t.data("trigger"):"hover focus"})})},500))},destroyTooltips=function(){try{if(void 0===$(window).tooltip)return;$(window.SELECTOR_TOOLTIP).tooltip("destroy")}catch(t){}};$(window).on(window.EVENT_DESTROY_TOOLTIPS,destroyTooltips).on([window.EVENT_INIT_TOOLTIPS].join(" "),initTooltips),$(function(){initTooltips(),"ontouchstart"in document.documentElement||($("a[title]").tooltip({container:"body",placement:"bottom"}),$("button[title]").tooltip({container:"body",placement:"bottom"}),$("img[title]").tooltip({container:"body",placement:"bottom"}),$("span[title]").tooltip({container:"body",placement:"bottom"}))}),function(t){t(function(){t(document).on("click",".w-choose-city-widget",function(){window.showSelectCityModal(window.changeCity,function(){},function(){},t(this).attr("data-city-id"))})})}(jQuery),$(function(){$.each($("[data-role=collapsible]"),function(t,e){var n=$(e),o=$("a[href=\\#"+n.attr("id")+"]"),i=o.find("[data-role=collapse-label]"),r=i.text();n.on("hidden.bs.collapse",function(){i.text(r),$("html, body").animate({scrollTop:n.offset().top},500)}).on("shown.bs.collapse",function(){i.text(o.attr("data-expanded-text"))}).click(function(){return!1})})}),function(t,e){e(function(){e(".tiny-mce-spoiler > .spoiler-head").each(function(){e('<span class="spoiler-arrow"></span>').appendTo(e(this))})}),e(function(){e(".tiny-mce-spoiler > .spoiler-head").attr("title","Развернуть спойлер").click(function(){var t=e(this).next(".tiny-mce-spoiler > .spoiler-body");t.toggle(),t.is(":hidden")?(e(this).attr("title","Развернуть спойлер"),e(this).removeClass("opened")):(e(this).attr("title","Свернуть спойлер"),e(this).addClass("opened"))})})}(document,jQuery);